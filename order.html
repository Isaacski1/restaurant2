<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Email.js SDK -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
  </script>
  <script type="text/javascript">
    (function () {
      emailjs.init({
        publicKey: "-WX6aDIktn3nAw81E",
      });
    })();
  </script>

  <title>Order Food | Isaacski Restaurant</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!--===============================================================================================-->
  <!-- Paystack -->
  <script src="https://js.paystack.co/v1/inline.js"></script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" />
  <!--===============================================================================================-->
  <link rel="icon" type="image/png" href="images/icons/favicon.png" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css" />

  <link rel="stylesheet" href="./css/order.css" />

  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="fonts/themify/themify-icons.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/slick/slick.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/lightbox2/css/lightbox.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="css/util.css" />
  <link rel="stylesheet" type="text/css" href="css/main.css" />
  <!--===============================================================================================-->
</head>

<body class="animsition">
  <!-- Header -->
  <header>
    <!-- Header desktop -->
    <div class="wrap-menu-header gradient1 trans-0-4">
      <div class="container h-full">
        <div class="wrap_header trans-0-3">
          <!-- Logo -->
          <div class="logo">
            <a href="index.html">
              <img src="images/icons/logo.png" alt="IMG-LOGO" data-logofixed="images/icons/logo1.png" />
            </a>
          </div>

          <!-- Menu -->
          <div class="wrap_menu p-l-45 p-l-0-xl">
            <nav class="menu">
              <ul class="main_menu">
                <li>
                  <a href="index.html">Home</a>
                </li>

                <li>
                  <a href="menu.html">Menu</a>
                </li>

                <li>
                  <a href="reservation.html">Reservation</a>
                </li>

                <li>
                  <a href="order.html">Order</a>
                </li>

                <li>
                  <a href="gallery.html">Gallery</a>
                </li>

                <li>
                  <a href="about.html">About</a>
                </li>

                <li>
                  <a href="blog.html">Blog</a>
                </li>

                <li>
                  <a href="contact.html">Contact</a>
                </li>
              </ul>
            </nav>
          </div>

          <!-- Social -->
          <div class="social flex-w flex-l-m p-r-20">
            <a href="#"><i class="fa fa-facebook m-l-21" aria-hidden="true"></i></a>
            <a href="#"><i class="fa fa-twitter m-l-21" aria-hidden="true"></i></a>

            <button class="btn-show-sidebar m-l-33 trans-0-4"></button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar trans-0-4">
    <!-- Button Hide sidebar -->
    <button class="btn-hide-sidebar ti-close color0-hov trans-0-4"></button>

    <!-- - -->
    <ul class="menu-sidebar p-t-95 p-b-70">
      <li class="t-center m-b-13">
        <a href="index.html" class="txt19">Home</a>
      </li>

      <li class="t-center m-b-13">
        <a href="menu.html" class="txt19">Menu</a>
      </li>

      <li class="t-center m-b-13">
        <a href="gallery.html" class="txt19">Gallery</a>
      </li>

      <li class="t-center m-b-13">
        <a href="about.html" class="txt19">About</a>
      </li>

      <li class="t-center m-b-13">
        <a href="reservation.html">Reservation</a>
      </li>

      <li class="t-center m-b-13">
        <a href="blog.html" class="txt19">Blog</a>
      </li>

      <li class="t-center m-b-33">
        <a href="contact.html" class="txt19">Contact</a>
      </li>

      <li class="t-center">
        <!-- Button3 -->
        <a href="order.html" class="btn3 flex-c-m size13 txt11 trans-0-4 m-l-r-auto">
          Order Online
        </a>
      </li>
    </ul>

    <!-- - -->
    <div class="gallery-sidebar t-center p-l-60 p-r-60 p-b-40">
      <!-- - -->
      <h4 class="txt20 m-b-33">Gallery</h4>

      <!-- Gallery -->
      <div class="wrap-gallery-sidebar flex-w">
        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-01.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-01.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-02.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-02.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-03.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-03.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-05.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-05.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-06.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-06.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-07.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-07.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-09.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-09.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-10.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-10.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-11.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-11.jpg" alt="GALLERY" />
        </a>
      </div>
    </div>
  </aside>



  <!-- Food Selection Categories Start -->
  <section class="container-fluid food-selection">
    <!-- Title Page -->
    <div class="bg-title-page flex-c-m p-t-100 p-b-80 p-l-15 p-r-15">
      <h2 class="tit6 t-center">Make Your Order Now</h2>
    </div>
    <div class="container food-selection-row mx-auto">
      <form id="paymentForm" class="row orderForm">
        <!-- Your existing form fields remain the same -->
        <div class="food-selection-col col-lg-4 col-md-12 pb-5 border">
          <h1 class="food-selection-col-title">Fill Your Details</h1>

          <div class="input-boxs my-4">
            <label for="full_name">Full Name</label>
            <input type="text" name="fullname" id="fullname" class="input-fill" required />
          </div>

          <div class="input-boxs my-4">
            <label for="email">Email Address</label>
            <input type="email" name="email" id="email" class="input-fill" required />
          </div>

          <div class="input-boxs my-4">
            <label for="telephone">Telephone</label>
            <input type="tel" name="telephone" id="telephone" class="input-fill" required />
          </div>
          <!-- Vendor Location -->

          <div class="input-boxs my-4">
            <label for="vendor-location">Vendor Location</label>
            <select name="vendor_location" id="vendor_location" class="input-fill" required>
              <option value="" disabled selected>Select Location</option>
              <option value="central-market">Central Market</option>
              <option value="swedru-zongo">Swedru Zongo</option>
              <option value="akwaa-mor">Akwakwaa-Mor</option>
              <option value="mahalla">Mahalla</option>
              <option value="pipe-tank">Pipe Tank</option>
              <option value="chapel-square">Chapel Square</option>
              <option value="abodom-road">Abodom Road</option>
              <option value="agip">Agip</option>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="message">Additional Notes</label>
            <textarea name="message" class="txt-box" id="message" rows="10"
              placeholder="Any Special Request Or Additional Instructions"></textarea>
          </div>
        </div>
        <div class="food-selection-col col-lg-6 col-md-12 border">
          <h1 class="food-selection-col-title">Make Your Dish</h1>
          <div class="input-boxs my-4">
            <label for="main_dishes">Main Dishes</label>
            <select name="main_dishes" id="main_dishes" class="input-fill" required>
              <option value="" disabled selected>Select Main Dish</option>
              <optgroup label="Fufu">
                <option value="Fufu with Light Soup - Â¢10.00">
                  Fufu with Light Soup - Â¢10.00
                </option>
                <option value="Fufu with Groundnut Soup - Â¢10.00">
                  Fufu with Groundnut Soup - Â¢10.00
                </option>
                <option value="Fufu with Palmnut Soup - Â¢10.00">
                  Fufu with Palmnut Soup - Â¢10.00
                </option>
                <option value="Fufu with Green Soup - Â¢8.00">
                  Fufu with Green Soup - Â¢8.00
                </option>
              </optgroup>
              <optgroup label="Banku">
                <option value="Banku with Okro Soup only - Â¢15.00">
                  Banku with Okro Soup only - Â¢15.00
                </option>
                <option value="Banku with Okro Soup and Groundnut Soup - Â¢20.00">
                  Banku with Okro Soup and Groundnut Soup - Â¢20.00
                </option>
                <option value="Banku with Groundnut Soup only - Â¢10.00">
                  Banku with Groundnut Soup only - Â¢10.00
                </option>
              </optgroup>
              <optgroup label="Waakye">
                <option value="Waakye with Tomato Sauce + Shitor - Â¢15.00">
                  Waakye with Tomato Sauce + Shitor - Â¢15.00
                </option>
                <option value="Waakye with Tomato Sauce only - Â¢13.00">
                  Waakye with Tomato Sauce only - Â¢13.00
                </option>
                <option value="Waakye with Shitor only - Â¢13.00">
                  Waakye with Shitor only - Â¢13.00
                </option>
              </optgroup>
              <optgroup label="Jollof">
                <option value="Jollof - Â¢20.00">Jollof - Â¢20.00</option>
              </optgroup>
              <optgroup label="Fried Rice">
                <option value="Fried Rice - Â¢25.00">Fried Rice - Â¢25.00</option>
              </optgroup>
              <optgroup label="Plain Rice">
                <option value="Plain Rice with Kontonmire Stew - Â¢15.00">
                  Plain Rice with Kontonmire Stew - Â¢15.00
                </option>
                <option value="Plain Rice with Tomato Sauce - Â¢10.00">
                  Plain Rice with Tomato Sauce - Â¢10.00
                </option>
                <option value="Plain Rice with Vegetable Stew - Â¢15.00">
                  Plain Rice with Vegetable Stew - Â¢15.00
                </option>
              </optgroup>
              <optgroup label="Tuo Zaafi">
                <option value="Tuo Zaafi with Green Soup - Â¢20.00">
                  Tuo Zaafi with Green Soup - Â¢20.00
                </option>
              </optgroup>
              <optgroup label="Plantain">
                <option value="Plantain with Kontonmire Stew - Â¢12.00">
                  Plantain with Kontonmire Stew - Â¢12.00
                </option>
                <option value="Plantain with Garden Egg Stew - Â¢9.00">
                  Plantain with/ Garden Egg Stew - Â¢9.00
                </option>
                <option value="Plantain with Vegetable Stew - Â¢12.00">
                  Plantain with Vegetable Stew - Â¢12.00
                </option>
              </optgroup>
              <optgroup label="Yam">
                <option value="Yam with Kontonmire Stew - Â¢8.00">
                  Yam with Kontonmire Stew - Â¢8.00
                </option>
                <option value="Yam with Garden Egg Stew - Â¢5.00">
                  Yam with Garden Egg Stew - Â¢5.00
                </option>
                <option value="Yam with Vegetable Stew - Â¢8.00">
                  Yam with Vegetable Stew - Â¢8.00
                </option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="protein">Protein</label>
            <select name="protein" id="protein" class="input-fill" required>
              <option value="" disabled selected>Select Protein</option>
              <optgroup label="Fish">
                <option value="Red Fish - Â¢7.00">Red Fish - Â¢7.00</option>
                <option value="Tilapia - Â¢17.00">Tilapia - Â¢17.00</option>
                <option value="Cassava Fish - Â¢7.00">
                  Cassava Fish - Â¢7.00
                </option>
              </optgroup>
              <optgroup label="Regular Meat">
                <option value="Cow Meat - Â¢20.00">
                  Cow Meat - Â¢20.00
                </option>
                <option value="Goat Meat - Â¢10.00">
                  Goat Meat - Â¢10.00
                </option>
                <option value="Chicken - Â¢7.00">Chicken - Â¢7.00</option>
                <option value="Cow & Sheep - Â¢25.00">Cow & Sheep - Â¢25.00</option>
                <option value="Sheep & Goat - Â¢20.00">Sheep & Goat - Â¢20.00</option>
              </optgroup>
              <optgroup label="Bush Meat">
                <option value="Kusie - Â¢30.00">
                  Kusie - Â¢30.00
                </option>
                <option value="Akrantie - Â¢40.00">
                  Akrantie only - Â¢40.00
                </option>
              </optgroup>
              <optgroup label="Others">
                <option value="Snail - Â¢17.00">Snail - Â¢17.00</option>
                <option value="Crab - Â¢6.00">Crab - Â¢6.00</option>
                <option value="Egg - Â¢1.50">Egg - Â¢1.50</option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Protein2">Extra Protein</label>
            <select name="protein2" id="protein2" class="input-fill">
              <option value="" disabled selected>Select Extra Protein</option>
              <optgroup label="Fish">
                <option value="Red Fish - Â¢7.00">Red Fish - Â¢7.00</option>
                <option value="Tilapia - Â¢17.00">Tilapia - Â¢17.00</option>
                <option value="Cassava Fish - Â¢7.00">
                  Cassava Fish - Â¢7.00
                </option>
              </optgroup>
              <optgroup label="Regular Meat">
                <option value="Cow Meat - Â¢20.00">
                  Cow Meat - Â¢20.00
                </option>
                <option value="Goat Meat - Â¢10.00">
                  Goat Meat - Â¢10.00
                </option>
                <option value="Chicken - Â¢7.00">Chicken - Â¢7.00</option>
                <option value="Cow & Sheep - Â¢25.00">Cow & Sheep - Â¢25.00</option>
                <option value="Sheep & Goat - Â¢20.00">Sheep & Goat - Â¢20.00</option>
              </optgroup>
              <optgroup label="Bush Meat">
                <option value="Kusie - Â¢30.00">
                  Kusie - Â¢30.00
                </option>
                <option value="Akrantie - Â¢40.00">
                  Akrantie only - Â¢40.00
                </option>
              </optgroup>
              <optgroup label="Others">
                <option value="Snail - Â¢17.00">Snail - Â¢17.00</option>
                <option value="Crab - Â¢6.00">Crab - Â¢6.00</option>
                <option value="Egg - Â¢1.50">Egg - Â¢1.50</option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Accompaniment">Accompaniment</label>
            <select name="Accompaniment" id="Accompaniment" title="Accompaniment" class="input-fill">
              <option value="" disabled selected>Select Accompaniment</option>
              <option value="Salad w/ Cream - Â¢8.00">
                Salad with Cream - Â¢8.00
              </option>
              <option value="Salad only - Â¢5.00">Salad only - Â¢5.00</option>
              <option value="Gari only - Â¢3.00">Gari only - Â¢3.00</option>
              <option value="Noodles only - Â¢5.00">
                Noodles only - Â¢5.00
              </option>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Drinks">Drinks</label>
            <select id="Drinks" name="Drinks" title="Drinks" class="input-fill">
              <option value="" disabled selected>Select Drink</option>
              <optgroup label="Water">
                <option value="Bottled Water 500ml - Â¢5.00">
                  Bottled Water, 500ml - Â¢5.00
                </option>
                <option value="Bottled Water 1L - Â¢10.00">
                  Bottled Water, 1L - Â¢10.00
                </option>
                <option value="Sachet Water 500ml - Â¢0.50">
                  Sachet Water 500ml - Â¢0.50
                </option>
              </optgroup>
              <optgroup label="Non-Alcoholic Beverages">
                <option value="Fanta 300ml - Â¢8.00">
                  Fanta, 300ml - Â¢8.00
                </option>
                <option value="Sprite 300ml - Â¢8.00">
                  Sprite, 300ml - Â¢8.00
                </option>
                <option value="Coca Cola 300ml - Â¢8.00">
                  Coca Cola, 300ml - Â¢8.00
                </option>
              </optgroup>
              <optgroup label="Alcoholic Beverages">
                <option value="Guinness 300ml - Â¢15.00">
                  Guinness, 300ml - Â¢15.00
                </option>
                <option value="Smirnoff 300ml - Â¢18.00">
                  Smirnoff, 300ml - Â¢18.00
                </option>
                <option value="Herbafric 300ml - Â¢13.00">
                  Herbafric, 300ml - Â¢13.00
                </option>
                <option value="Beer 330ml - Â¢15.00">
                  Beer, 330ml - Â¢15.00
                </option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Packaging">Packaging</label>
            <select id="Packaging" name="Packaging" title="Packaging" class="input-fill" required>
              <option value="" disabled selected>Select Packaging</option>
              <optgroup label="In Paper Bag">
                <option value="TakeAway Pack - Â¢2.00">
                  TakeAway Pack - Â¢2.00
                </option>
                <option value="Soup Bowl - Â¢5.00">Soup Bowl - Â¢5.00</option>
              </optgroup>
              <optgroup label="VIP">
                <option value="Asanka Special - Â¢20.00">
                  Asanka Special - Â¢20.00
                </option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Delivery">Delivery Period</label>
            <select id="Delivery" name="Delivery" title="Delivery Period" class="input-fill" required>
              <option value="" disabled selected>
                Select Delivery Period
              </option>
              <option value="Tomorrow - Â¢4.50">Tomorrow - Â¢4.50</option>
              <option value="Today - Â¢6.50">Today - Â¢6.50</option>
              <option value="Within Two Hours - Â¢8.50">
                Within 2 Hours - Â¢8.50
              </option>
            </select>
          </div>

          <!-- Total Cost Section -->
          <div class="input-boxs my-4" id="total-cost-box" style="text-align: center">
            <h3>
              Total Cost:
              <span id="total-cost" style="color: #cf2227">Â¢0.00</span>
            </h3>
          </div>

          <button type="button" id="pay-now-btn" class="btn btn-danger btn-lg mt-3">
            Pay Now
          </button>
          <input type="hidden" id="amount" name="Amount" value="0" />
        </div>
      </form>
    </div>
  </section>
  <!-- Food Selection Categories End -->

  <!-- Add this somewhere in your order.html -->
  <div class="mt-4 p-3 border rounded bg-light">
    <h5>Firebase Test</h5>
    <button id="testFirebaseBtn" class="btn btn-warning btn-sm">
      Test Firebase Connection
    </button>
    <div id="testResult" class="mt-2"></div>
  </div>

  <!-- Chat Us On Whatsapp -->
  <a href="https://api.whatsapp.com/send?phone=233549175604&text=Hello%20Isaacski%20Restaurant" class="whatsapp-chat"
    target="_blank" rel="noopener noreferrer">
    <i class="fa fa-whatsapp" aria-hidden="true"></i>
  </a>





  <!-- Firebase Configuration -->
  <script src="js/firebase-config.js"></script>

  <script>
    // Test Firebase connection
    document.getElementById('testFirebaseBtn').addEventListener('click', function () {
      const testResult = document.getElementById('testResult');

      try {
        // Test if Firebase is available
        if (typeof firebase === 'undefined') {
          testResult.innerHTML = '<span class="text-danger">âŒ Firebase not loaded</span>';
          return;
        }

        if (!firebase.apps.length) {
          testResult.innerHTML = '<span class="text-danger">âŒ Firebase not initialized</span>';
          return;
        }

        // Test Firestore write
        const testData = {
          test: true,
          message: "Firebase test successful",
          timestamp: new Date()
        };

        firebase.firestore().collection('test').add(testData)
          .then((docRef) => {
            testResult.innerHTML = '<span class="text-success">âœ… Firebase working! Test document created.</span>';
            console.log("Test document ID:", docRef.id);
          })
          .catch((error) => {
            testResult.innerHTML = `<span class="text-danger">âŒ Firebase error: ${error.message}</span>`;
            console.error("Firebase test error:", error);
          });

      } catch (error) {
        testResult.innerHTML = `<span class="text-danger">âŒ Error: ${error.message}</span>`;
        console.error("Test error:", error);
      }
    });
  </script>

  <!-- Add this to your order.html -->
  <script>

    // Test function to check if orders are saving
    function testOrderSave() {
      const testOrder = {
        customerName: "Test Customer",
        customerEmail: "test@example.com",
        customerPhone: "1234567890",
        items: [
          { name: "Test Item", price: 10.99, quantity: 1 }
        ],
        total: 10.99,
        status: "pending",
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      };

      db.collection('orders').add(testOrder)
        .then((docRef) => {
          console.log("Test order saved with ID: ", docRef.id);
          alert("Test order saved successfully! Check Firebase console.");
        })
        .catch((error) => {
          console.error("Error saving test order: ", error);
          alert("Error saving test order: " + error.message);
        });
    }

    // Call this function to test
    // testOrderSave();
  </script>

  <script>
    // Initialize EmailJS
    (function () {
      emailjs.init("-WX6aDIktn3nAw81E");
    })();

    // Total Cost Calculation (Keep your existing code)
    function extractPrice(val) {
      if (!val) return 0;
      var match = val.match(/Â¢([\d.]+)/);
      return match ? parseFloat(match[1]) : 0;
    }

    function do_total() {
      var total = 0;

      // Main Dish
      var main = document.getElementById("main_dishes");
      if (main && main.value) total += extractPrice(main.value);

      // Protein
      var protein = document.getElementById("protein");
      if (protein && protein.value)
        total += extractPrice(protein.value);

      // Extra Protein
      var protein2 = document.getElementById("protein2");
      if (protein2 && protein2.value)
        total += extractPrice(protein2.value);

      // Accompaniment
      var acc = document.getElementById("Accompaniment");
      if (acc && acc.value) total += extractPrice(acc.value);

      // Drinks
      var drink = document.getElementById("Drinks");
      if (drink && drink.value) total += extractPrice(drink.value);

      // Packaging
      var packaging = document.getElementById("Packaging");
      if (packaging && packaging.value)
        total += extractPrice(packaging.value);

      // Delivery
      var delivery = document.getElementById("Delivery");
      if (delivery && delivery.value)
        total += extractPrice(delivery.value);

      // Show total
      document.getElementById("total-cost").textContent =
        "Â¢" + total.toFixed(2);
      document.getElementById("amount").value = total.toFixed(2);
    }

    // Attach do_total to all relevant selects
    document.addEventListener("DOMContentLoaded", function () {
      [
        "main_dishes",
        "protein",
        "protein2",
        "Accompaniment",
        "Drinks",
        "Packaging",
        "Delivery",
      ].forEach(function (id) {
        var el = document.getElementById(id);
        if (el) el.addEventListener("change", do_total);
      });

      // Initial calculation
      do_total();
    });

    // Save order to Firebase
    async function saveOrderToFirebase(orderData, orderId, paymentReference) {
      try {
        const firebaseOrderData = {
          orderId: orderId,
          customerName: orderData.fullname,
          customerEmail: orderData.email,
          customerPhone: orderData.telephone,
          vendorLocation: orderData.vendor_location,
          additionalNotes: orderData.message || 'None',

          // Order items
          mainDish: orderData.main_dishes,
          protein: orderData.protein,
          extraProtein: orderData.protein2 || 'None',
          accompaniment: orderData.Accompaniment || 'None',
          drinks: orderData.Drinks || 'None',
          packaging: orderData.Packaging,
          deliveryPeriod: orderData.Delivery,

          // Payment details
          totalAmount: parseFloat(document.getElementById('amount').value),
          currency: 'GHS',
          paymentReference: paymentReference,
          paymentStatus: 'completed',
          orderStatus: 'pending',

          // Timestamps
          timestamp: firebase.firestore.FieldValue.serverTimestamp(),
          orderDate: new Date().toISOString()
        };

        // Save to Firebase
        await db.collection('orders').doc(orderId).set(firebaseOrderData);
        console.log('Order saved to Firebase successfully');
        return true;
      } catch (error) {
        console.error('Error saving order to Firebase:', error);
        return false;
      }
    }

    // Paystack Payment with Firebase Integration
    document.getElementById("pay-now-btn").addEventListener("click", function () {
      const form = document.getElementById("paymentForm");
      const formData = new FormData(form);
      const data = {};
      formData.forEach((value, key) => {
        data[key] = value;
      });

      // Basic validation
      if (!data.fullname || !data.email || !data.telephone || !data.vendor_location) {
        alert("Please fill in all required fields: Full Name, Email, Telephone, and Vendor Location.");
        return;
      }

      if (!data.main_dishes || !data.protein || !data.Packaging || !data.Delivery) {
        alert("Please select Main Dish, Protein, Packaging, and Delivery Period.");
        return;
      }

      // Get total
      const totalText = document.getElementById("total-cost").textContent;
      const total = totalText.replace(/[^\d.]/g, "");
      if (!total || isNaN(parseFloat(total)) || parseFloat(total) <= 0) {
        alert("Please select your meal to calculate total cost.");
        return;
      }

      if (typeof PaystackPop === "undefined") {
        alert("Paystack is not loaded. Check your internet connection.");
        return;
      }

      // Generate order ID
      const orderId = 'ORDER-' + Math.random().toString(36).substr(2, 6).toUpperCase();

      const handler = PaystackPop.setup({
        key: "pk_test_daec5eba6470db795511d6c5b8b29469f938ea34",
        email: data.email,
        amount: parseFloat(total) * 100,
        currency: "GHS",
        ref: orderId,
        metadata: {
          custom_fields: [
            {
              display_name: "Full Name",
              variable_name: "full_name",
              value: data.fullname
            },
            {
              display_name: "Telephone",
              variable_name: "telephone",
              value: data.telephone
            },
            {
              display_name: "Order ID",
              variable_name: "order_id",
              value: orderId
            }
          ]
        },
        callback: function (response) {
          handlePaymentSuccess(response, data, orderId);
        },
        onClose: function () {
          alert("Payment was cancelled.");
        },
      });

      handler.openIframe();
    });

    async function handlePaymentSuccess(response, data, orderId) {
      try {
        // 1. Save to Firebase first
        const firebaseSaved = await saveOrderToFirebase(data, orderId, response.reference);

        if (!firebaseSaved) {
          throw new Error('Failed to save order to database');
        }

        // 2. Send email using Email.js
        const templateParams = {
          // Customer Information
          fullname: data.fullname,
          email: data.email,
          telephone: data.telephone,
          vendor_location: data.vendor_location,
          message: data.message,

          // Food Selection
          main_dishes: data.main_dishes,
          protein: data.protein,
          protein2: data.protein2 || 'None',
          accompaniment: data.Accompaniment || 'None',
          drinks: data.Drinks || 'None',
          packaging: data.Packaging,
          delivery: data.Delivery,

          // Order & Payment Details
          total_cost: document.getElementById('total-cost').textContent,
          order_id: orderId,
          payment_reference: response.reference,
          timestamp: new Date().toLocaleString()
        };

        // Send email via Email.js
        await emailjs.send('service_uvwuw6g', 'template_phvfhln', templateParams);
        console.log('Email sent successfully via Email.js');

        // 3. Format WhatsApp message
        const whatsappMessage = `New Order Payment Successful! ğŸ’°
Order ID: ${orderId}
Payment Ref: ${response.reference}

Customer Details:
ğŸ‘¤ Full Name: ${data.fullname}
ğŸ“§ Email: ${data.email}
ğŸ“ Phone: ${data.telephone}
ğŸ“ Vendor Location: ${data.vendor_location}

Order Details:
ğŸ› Main Dish: ${data.main_dishes}
ğŸ¥© Protein: ${data.protein}
ğŸ¥© Extra Protein: ${data.protein2 || 'None'}
ğŸ¥— Accompaniment: ${data.Accompaniment || 'None'}
ğŸ¥¤ Drinks: ${data.Drinks || 'None'}
ğŸ“¦ Packaging: ${data.Packaging}
ğŸšš Delivery: ${data.Delivery}

ğŸ’° Total: ${document.getElementById('total-cost').textContent}

ğŸ“ Additional Notes: ${data.message || 'None'}`;

        const whatsappLink = `https://wa.me/233549175604?text=${encodeURIComponent(whatsappMessage)}`;
        window.open(whatsappLink, "_blank");

        alert("ğŸ‰ Order submitted successfully and payment completed! Order ID: " + orderId);
        document.getElementById('paymentForm').reset();
        document.getElementById('total-cost').textContent = 'Â¢0.00';

      } catch (error) {
        console.error("Error during order processing:", error);
        alert("Payment was successful but there was an issue processing your order. Please contact us with your Order ID: " + orderId);
      }
    }
  </script>

  <!-- Footer -->
  <footer class="bg1">
    <div class="container p-t-40 p-b-70">
      <div class="row">
        <div class="col-sm-6 col-md-4 p-t-50">
          <!-- - -->
          <h4 class="txt13 m-b-33">Contact Us</h4>

          <ul class="m-b-70">
            <li class="txt14 m-b-14">
              <i class="fa fa-map-marker fs-16 dis-inline-block size19" aria-hidden="true"></i>
              East Legon, Accra, Ghana
            </li>

            <li class="txt14 m-b-14">
              <i class="fa fa-phone fs-16 dis-inline-block size19" aria-hidden="true"></i>
              (+233) 24 123 4567
            </li>

            <li class="txt14 m-b-14">
              <i class="fa fa-envelope fs-13 dis-inline-block size19" aria-hidden="true"></i>
              <a href="mailto:restaurant@gmail.com" class="__cf_email__"
                data-cfemail="7d1e1213091c1e093d0e140918531e1210">restaurant@gmail.com</a>
            </li>
          </ul>

          <!-- - -->
          <h4 class="txt13 m-b-32">Opening Times</h4>

          <ul>
            <li class="txt14">08:30 AM â€“ 08:00 PM</li>

            <li class="txt14">Every Day</li>
          </ul>
        </div>

        <div class="col-sm-6 col-md-4 p-t-50">
          <!-- - -->
          <h4 class="txt13 m-b-33">Latest twitter</h4>

          <div class="m-b-25">
            <span class="fs-13 color2 m-r-5">
              <i class="fa fa-twitter" aria-hidden="true"></i>
            </span>
            <a href="#" class="txt15"> @Isaacski Restaurant </a>

            <p class="txt14 m-b-18">
              Excited to announce our new menu! Try our chef's specials this
              weekend.
              <a href="#" class="txt15"> www.isaacskirestaurant.com </a>
            </p>

            <span class="txt16"> 21 Dec 2017 </span>
          </div>

          <div>
            <span class="fs-13 color2 m-r-5">
              <i class="fa fa-twitter" aria-hidden="true"></i>
            </span>
            <a href="#" class="txt15"> @Big Restaurant </a>

            <p class="txt14 m-b-18">
              Join us for our grand opening! Enjoy live music, delicious food,
              and great company.
              <a href="#" class="txt15"> www.bigrestaurant.com </a>
            </p>

            <span class="txt16"> 21 Dec 2017 </span>
          </div>
        </div>

        <div class="col-sm-6 col-md-4 p-t-50">
          <!-- - -->
          <h4 class="txt13 m-b-38">Gallery</h4>

          <!-- Gallery footer -->
          <div class="wrap-gallery-footer flex-w">
            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-01.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-01.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-02.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-02.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-03.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-03.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-04.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-04.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-05.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-05.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-06.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-06.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-07.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-07.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-08.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-08.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-09.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-09.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-10.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-10.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-11.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-11.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-12.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-12.jpg" alt="GALLERY" />
            </a>
          </div>
        </div>
      </div>
    </div>

    <div class="end-footer bg2">
      <div class="container">
        <div class="flex-sb-m flex-w p-t-22 p-b-22">
          <div class="p-t-5 p-b-5">
            <a href="#" class="fs-15 c-white"><i class="fa fa-instagram m-l-18" aria-hidden="true"></i></a>
            <a href="#" class="fs-15 c-white"><i class="fa fa-facebook m-l-18" aria-hidden="true"></i></a>
            <a href="#" class="fs-15 c-white"><i class="fa fa-twitter m-l-18" aria-hidden="true"></i></a>
          </div>

          <div class="txt17 p-r-20 p-t-5 p-b-5">
            @ 2025 Isaacski Web Development Agency.
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- Back to top -->
  <div class="btn-back-to-top bg0-hov" id="myBtn">
    <span class="symbol-btn-back-to-top">
      <i class="fa fa-angle-double-up" aria-hidden="true"></i>
    </span>
  </div>

  <!-- Chat Us On Whatsapp -->
  <a href="https://api.whatsapp.com/send?phone=233549175604&text=Hello%20Isaacski%20Restaurant" class="whatsapp-chat"
    target="_blank" rel="noopener noreferrer">
    <i class="fa fa-whatsapp" aria-hidden="true"></i>
  </a>

  <!-- In your order.html, add these scripts before closing </body> -->

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <!-- Your order system -->
  <script src="js/order-system.js"></script>

  <!-- Test button HTML (add this to your form) -->
  <div class="mt-3">
    <button type="button" id="testOrderBtn" class="btn btn-warning">
      <i class="fas fa-vial"></i> Test Order Save
    </button>
    <small class="text-muted d-block">Click this to test if orders save to Firebase</small>
  </div>

  <script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
  <script type="text/javascript" src="vendor/jquery/jquery-3.2.1.min.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/animsition/js/animsition.min.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/bootstrap/js/popper.js"></script>
  <script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>

  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/select2/select2.min.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/daterangepicker/moment.min.js"></script>
  <script type="text/javascript" src="vendor/daterangepicker/daterangepicker.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/slick/slick.min.js"></script>
  <script type="text/javascript" src="js/slick-custom.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/parallax100/parallax100.js"></script>
  <script type="text/javascript">
    $(".parallax100").parallax100();
  </script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/countdowntime/countdowntime.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/lightbox2/js/lightbox.min.js"></script>
  <!--===============================================================================================-->
  <script src="js/main.js"></script>
  <script src="js/payment.js"></script>
  <script src="js/whatsaap-api.js"></script>
  <script src="js/script.js"></script>
  <script src="js/email-template.js"></script>

  <script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
    integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ=="
    data-cf-beacon='{"rayId":"94b79e40ee6cee0a","version":"2025.5.0","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"cd0b4b3a733644fc843ef0b185f98241","b":1}'
    crossorigin="anonymous"></script>
</body>

</html>