<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Email.js SDK -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
  </script>
  <script type="text/javascript">
    (function () {
      emailjs.init({
        publicKey: "-WX6aDIktn3nAw81E",
      });
    })();
  </script>

  <title>Order Food | Isaacski Restaurant</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!--===============================================================================================-->
  <!-- Paystack -->
  <script src="https://js.paystack.co/v1/inline.js"></script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" />
  <!--===============================================================================================-->
  <link rel="icon" type="image/png" href="images/icons/favicon.png" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css" />

  <link rel="stylesheet" href="./css/order.css" />

  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="fonts/themify/themify-icons.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/slick/slick.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/lightbox2/css/lightbox.min.css" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="css/util.css" />
  <link rel="stylesheet" type="text/css" href="css/main.css" />
  <!--===============================================================================================-->
</head>

<body class="animsition">
  <!-- Header -->
  <header>
    <!-- Header desktop -->
    <div class="wrap-menu-header gradient1 trans-0-4">
      <div class="container h-full">
        <div class="wrap_header trans-0-3">
          <!-- Logo -->
          <div class="logo">
            <a href="index.html">
              <img src="images/icons/logo.png" alt="IMG-LOGO" data-logofixed="images/icons/logo1.png" />
            </a>
          </div>

          <!-- Menu -->
          <div class="wrap_menu p-l-45 p-l-0-xl">
            <nav class="menu">
              <ul class="main_menu">
                <li>
                  <a href="index.html">Home</a>
                </li>

                <li>
                  <a href="menu.html">Menu</a>
                </li>

                <li>
                  <a href="reservation.html">Reservation</a>
                </li>

                <li>
                  <a href="order.html">Order</a>
                </li>

                <li>
                  <a href="gallery.html">Gallery</a>
                </li>

                <li>
                  <a href="about.html">About</a>
                </li>

                <li>
                  <a href="blog.html">Blog</a>
                </li>

                <li>
                  <a href="contact.html">Contact</a>
                </li>
              </ul>
            </nav>
          </div>

          <!-- Social -->
          <div class="social flex-w flex-l-m p-r-20">
            <a href="#"><i class="fa fa-facebook m-l-21" aria-hidden="true"></i></a>
            <a href="#"><i class="fa fa-twitter m-l-21" aria-hidden="true"></i></a>

            <button class="btn-show-sidebar m-l-33 trans-0-4"></button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar trans-0-4">
    <!-- Button Hide sidebar -->
    <button class="btn-hide-sidebar ti-close color0-hov trans-0-4"></button>

    <!-- - -->
    <ul class="menu-sidebar p-t-95 p-b-70">
      <li class="t-center m-b-13">
        <a href="index.html" class="txt19">Home</a>
      </li>

      <li class="t-center m-b-13">
        <a href="menu.html" class="txt19">Menu</a>
      </li>

      <li class="t-center m-b-13">
        <a href="gallery.html" class="txt19">Gallery</a>
      </li>

      <li class="t-center m-b-13">
        <a href="about.html" class="txt19">About</a>
      </li>

      <li class="t-center m-b-13">
        <a href="reservation.html">Reservation</a>
      </li>

      <li class="t-center m-b-13">
        <a href="blog.html" class="txt19">Blog</a>
      </li>

      <li class="t-center m-b-33">
        <a href="contact.html" class="txt19">Contact</a>
      </li>

      <li class="t-center">
        <!-- Button3 -->
        <a href="order.html" class="btn3 flex-c-m size13 txt11 trans-0-4 m-l-r-auto">
          Order Online
        </a>
      </li>
    </ul>

    <!-- - -->
    <div class="gallery-sidebar t-center p-l-60 p-r-60 p-b-40">
      <!-- - -->
      <h4 class="txt20 m-b-33">Gallery</h4>

      <!-- Gallery -->
      <div class="wrap-gallery-sidebar flex-w">
        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-01.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-01.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-02.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-02.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-03.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-03.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-05.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-05.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-06.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-06.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-07.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-07.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-09.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-09.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-10.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-10.jpg" alt="GALLERY" />
        </a>

        <a class="item-gallery-sidebar wrap-pic-w" href="images/photo-gallery-11.jpg" data-lightbox="gallery-footer">
          <img src="images/photo-gallery-thumb-11.jpg" alt="GALLERY" />
        </a>
      </div>
    </div>
  </aside>



  <!-- Food Selection Categories Start -->
  <section class="container-fluid food-selection">
    <!-- Title Page -->
    <div class="bg-title-page flex-c-m p-t-100 p-b-80 p-l-15 p-r-15">
      <h2 class="tit6 t-center">Make Your Order Now</h2>
    </div>
    <div class="container food-selection-row mx-auto">
      <form id="paymentForm" class="row orderForm">
        <!-- Your existing form fields remain the same -->
        <div class="food-selection-col col-lg-4 col-md-12 pb-5 border">
          <h1 class="food-selection-col-title">Fill Your Details</h1>

          <div class="input-boxs my-4">
            <label for="full_name">Full Name</label>
            <input type="text" name="fullname" id="fullname" class="input-fill" required />
          </div>

          <div class="input-boxs my-4">
            <label for="email">Email Address</label>
            <input type="email" name="email" id="email" class="input-fill" required />
          </div>

          <div class="input-boxs my-4">
            <label for="telephone">Telephone</label>
            <input type="tel" name="telephone" id="telephone" class="input-fill" required />
          </div>
          <!-- Vendor Location -->

          <div class="input-boxs my-4">
            <label for="vendor-location">Vendor Location</label>
            <select name="vendor_location" id="vendor_location" class="input-fill" required>
              <option value="" disabled selected>Select Location</option>
              <option value="central-market">Central Market</option>
              <option value="swedru-zongo">Swedru Zongo</option>
              <option value="akwaa-mor">Akwakwaa-Mor</option>
              <option value="mahalla">Mahalla</option>
              <option value="pipe-tank">Pipe Tank</option>
              <option value="chapel-square">Chapel Square</option>
              <option value="abodom-road">Abodom Road</option>
              <option value="agip">Agip</option>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="message">Additional Notes</label>
            <textarea name="message" class="txt-box" id="message" rows="10"
              placeholder="Any Special Request Or Additional Instructions"></textarea>
          </div>
        </div>
        <div class="food-selection-col col-lg-6 col-md-12 border">
          <h1 class="food-selection-col-title">Make Your Dish</h1>
          <div class="input-boxs my-4">
            <label for="main_dishes">Main Dishes</label>
            <select name="main_dishes" id="main_dishes" class="input-fill" required>
              <option value="" disabled selected>Select Main Dish</option>
              <optgroup label="Fufu">
                <option value="Fufu with Light Soup - ¬¢10.00">
                  Fufu with Light Soup - ¬¢10.00
                </option>
                <option value="Fufu with Groundnut Soup - ¬¢10.00">
                  Fufu with Groundnut Soup - ¬¢10.00
                </option>
                <option value="Fufu with Palmnut Soup - ¬¢10.00">
                  Fufu with Palmnut Soup - ¬¢10.00
                </option>
                <option value="Fufu with Green Soup - ¬¢8.00">
                  Fufu with Green Soup - ¬¢8.00
                </option>
              </optgroup>
              <optgroup label="Banku">
                <option value="Banku with Okro Soup only - ¬¢15.00">
                  Banku with Okro Soup only - ¬¢15.00
                </option>
                <option value="Banku with Okro Soup and Groundnut Soup - ¬¢20.00">
                  Banku with Okro Soup and Groundnut Soup - ¬¢20.00
                </option>
                <option value="Banku with Groundnut Soup only - ¬¢10.00">
                  Banku with Groundnut Soup only - ¬¢10.00
                </option>
              </optgroup>
              <optgroup label="Waakye">
                <option value="Waakye with Tomato Sauce + Shitor - ¬¢15.00">
                  Waakye with Tomato Sauce + Shitor - ¬¢15.00
                </option>
                <option value="Waakye with Tomato Sauce only - ¬¢13.00">
                  Waakye with Tomato Sauce only - ¬¢13.00
                </option>
                <option value="Waakye with Shitor only - ¬¢13.00">
                  Waakye with Shitor only - ¬¢13.00
                </option>
              </optgroup>
              <optgroup label="Jollof">
                <option value="Jollof - ¬¢20.00">Jollof - ¬¢20.00</option>
              </optgroup>
              <optgroup label="Fried Rice">
                <option value="Fried Rice - ¬¢25.00">Fried Rice - ¬¢25.00</option>
              </optgroup>
              <optgroup label="Plain Rice">
                <option value="Plain Rice with Kontonmire Stew - ¬¢15.00">
                  Plain Rice with Kontonmire Stew - ¬¢15.00
                </option>
                <option value="Plain Rice with Tomato Sauce - ¬¢10.00">
                  Plain Rice with Tomato Sauce - ¬¢10.00
                </option>
                <option value="Plain Rice with Vegetable Stew - ¬¢15.00">
                  Plain Rice with Vegetable Stew - ¬¢15.00
                </option>
              </optgroup>
              <optgroup label="Tuo Zaafi">
                <option value="Tuo Zaafi with Green Soup - ¬¢20.00">
                  Tuo Zaafi with Green Soup - ¬¢20.00
                </option>
              </optgroup>
              <optgroup label="Plantain">
                <option value="Plantain with Kontonmire Stew - ¬¢12.00">
                  Plantain with Kontonmire Stew - ¬¢12.00
                </option>
                <option value="Plantain with Garden Egg Stew - ¬¢9.00">
                  Plantain with/ Garden Egg Stew - ¬¢9.00
                </option>
                <option value="Plantain with Vegetable Stew - ¬¢12.00">
                  Plantain with Vegetable Stew - ¬¢12.00
                </option>
              </optgroup>
              <optgroup label="Yam">
                <option value="Yam with Kontonmire Stew - ¬¢8.00">
                  Yam with Kontonmire Stew - ¬¢8.00
                </option>
                <option value="Yam with Garden Egg Stew - ¬¢5.00">
                  Yam with Garden Egg Stew - ¬¢5.00
                </option>
                <option value="Yam with Vegetable Stew - ¬¢8.00">
                  Yam with Vegetable Stew - ¬¢8.00
                </option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="protein">Protein</label>
            <select name="protein" id="protein" class="input-fill" required>
              <option value="" disabled selected>Select Protein</option>
              <optgroup label="Fish">
                <option value="Red Fish - ¬¢7.00">Red Fish - ¬¢7.00</option>
                <option value="Tilapia - ¬¢17.00">Tilapia - ¬¢17.00</option>
                <option value="Cassava Fish - ¬¢7.00">
                  Cassava Fish - ¬¢7.00
                </option>
              </optgroup>
              <optgroup label="Regular Meat">
                <option value="Cow Meat - ¬¢20.00">
                  Cow Meat - ¬¢20.00
                </option>
                <option value="Goat Meat - ¬¢10.00">
                  Goat Meat - ¬¢10.00
                </option>
                <option value="Chicken - ¬¢7.00">Chicken - ¬¢7.00</option>
                <option value="Cow & Sheep - ¬¢25.00">Cow & Sheep - ¬¢25.00</option>
                <option value="Sheep & Goat - ¬¢20.00">Sheep & Goat - ¬¢20.00</option>
              </optgroup>
              <optgroup label="Bush Meat">
                <option value="Kusie - ¬¢30.00">
                  Kusie - ¬¢30.00
                </option>
                <option value="Akrantie - ¬¢40.00">
                  Akrantie only - ¬¢40.00
                </option>
              </optgroup>
              <optgroup label="Others">
                <option value="Snail - ¬¢17.00">Snail - ¬¢17.00</option>
                <option value="Crab - ¬¢6.00">Crab - ¬¢6.00</option>
                <option value="Egg - ¬¢1.50">Egg - ¬¢1.50</option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Protein2">Extra Protein</label>
            <select name="protein2" id="protein2" class="input-fill">
              <option value="" disabled selected>Select Extra Protein</option>
              <optgroup label="Fish">
                <option value="Red Fish - ¬¢7.00">Red Fish - ¬¢7.00</option>
                <option value="Tilapia - ¬¢17.00">Tilapia - ¬¢17.00</option>
                <option value="Cassava Fish - ¬¢7.00">
                  Cassava Fish - ¬¢7.00
                </option>
              </optgroup>
              <optgroup label="Regular Meat">
                <option value="Cow Meat - ¬¢20.00">
                  Cow Meat - ¬¢20.00
                </option>
                <option value="Goat Meat - ¬¢10.00">
                  Goat Meat - ¬¢10.00
                </option>
                <option value="Chicken - ¬¢7.00">Chicken - ¬¢7.00</option>
                <option value="Cow & Sheep - ¬¢25.00">Cow & Sheep - ¬¢25.00</option>
                <option value="Sheep & Goat - ¬¢20.00">Sheep & Goat - ¬¢20.00</option>
              </optgroup>
              <optgroup label="Bush Meat">
                <option value="Kusie - ¬¢30.00">
                  Kusie - ¬¢30.00
                </option>
                <option value="Akrantie - ¬¢40.00">
                  Akrantie only - ¬¢40.00
                </option>
              </optgroup>
              <optgroup label="Others">
                <option value="Snail - ¬¢17.00">Snail - ¬¢17.00</option>
                <option value="Crab - ¬¢6.00">Crab - ¬¢6.00</option>
                <option value="Egg - ¬¢1.50">Egg - ¬¢1.50</option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Accompaniment">Accompaniment</label>
            <select name="Accompaniment" id="Accompaniment" title="Accompaniment" class="input-fill">
              <option value="" disabled selected>Select Accompaniment</option>
              <option value="Salad w/ Cream - ¬¢8.00">
                Salad with Cream - ¬¢8.00
              </option>
              <option value="Salad only - ¬¢5.00">Salad only - ¬¢5.00</option>
              <option value="Gari only - ¬¢3.00">Gari only - ¬¢3.00</option>
              <option value="Noodles only - ¬¢5.00">
                Noodles only - ¬¢5.00
              </option>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Drinks">Drinks</label>
            <select id="Drinks" name="Drinks" title="Drinks" class="input-fill">
              <option value="" disabled selected>Select Drink</option>
              <optgroup label="Water">
                <option value="Bottled Water 500ml - ¬¢5.00">
                  Bottled Water, 500ml - ¬¢5.00
                </option>
                <option value="Bottled Water 1L - ¬¢10.00">
                  Bottled Water, 1L - ¬¢10.00
                </option>
                <option value="Sachet Water 500ml - ¬¢0.50">
                  Sachet Water 500ml - ¬¢0.50
                </option>
              </optgroup>
              <optgroup label="Non-Alcoholic Beverages">
                <option value="Fanta 300ml - ¬¢8.00">
                  Fanta, 300ml - ¬¢8.00
                </option>
                <option value="Sprite 300ml - ¬¢8.00">
                  Sprite, 300ml - ¬¢8.00
                </option>
                <option value="Coca Cola 300ml - ¬¢8.00">
                  Coca Cola, 300ml - ¬¢8.00
                </option>
              </optgroup>
              <optgroup label="Alcoholic Beverages">
                <option value="Guinness 300ml - ¬¢15.00">
                  Guinness, 300ml - ¬¢15.00
                </option>
                <option value="Smirnoff 300ml - ¬¢18.00">
                  Smirnoff, 300ml - ¬¢18.00
                </option>
                <option value="Herbafric 300ml - ¬¢13.00">
                  Herbafric, 300ml - ¬¢13.00
                </option>
                <option value="Beer 330ml - ¬¢15.00">
                  Beer, 330ml - ¬¢15.00
                </option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Packaging">Packaging</label>
            <select id="Packaging" name="Packaging" title="Packaging" class="input-fill" required>
              <option value="" disabled selected>Select Packaging</option>
              <optgroup label="In Paper Bag">
                <option value="TakeAway Pack - ¬¢2.00">
                  TakeAway Pack - ¬¢2.00
                </option>
                <option value="Soup Bowl - ¬¢5.00">Soup Bowl - ¬¢5.00</option>
              </optgroup>
              <optgroup label="VIP">
                <option value="Asanka Special - ¬¢20.00">
                  Asanka Special - ¬¢20.00
                </option>
              </optgroup>
            </select>
          </div>

          <div class="input-boxs my-4">
            <label for="Delivery">Delivery Period</label>
            <select id="Delivery" name="Delivery" title="Delivery Period" class="input-fill" required>
              <option value="" disabled selected>
                Select Delivery Period
              </option>
              <option value="Tomorrow - ¬¢4.50">Tomorrow - ¬¢4.50</option>
              <option value="Today - ¬¢6.50">Today - ¬¢6.50</option>
              <option value="Within Two Hours - ¬¢8.50">
                Within 2 Hours - ¬¢8.50
              </option>
            </select>
          </div>

          <!-- Total Cost Section -->
          <div class="input-boxs my-4" id="total-cost-box" style="text-align: center">
            <h3>
              Total Cost:
              <span id="total-cost" style="color: #cf2227">¬¢0.00</span>
            </h3>
          </div>

          <button type="button" id="pay-now-btn" class="btn btn-danger btn-lg mt-3">
            Pay Now
          </button>
          <input type="hidden" id="amount" name="Amount" value="0" />
        </div>
      </form>
    </div>
  </section>
  <!-- Food Selection Categories End -->

  <!-- Firebase Test Section -->
  <div class="container mt-4 p-3 border rounded bg-light">
    <h5>Firebase Order Test</h5>
    <button onclick="testFirebaseSave()" class="btn btn-info btn-sm">
      Test Firebase Order Save
    </button>
    <button id="testFirebaseBtn" class="btn btn-warning btn-sm">
      Test Firebase Connection
    </button>
    <div id="testResult" class="mt-2"></div>
  </div>

  <!-- Chat Us On Whatsapp -->
  <a href="https://api.whatsapp.com/send?phone=233549175604&text=Hello%20Isaacski%20Restaurant" class="whatsapp-chat"
    target="_blank" rel="noopener noreferrer">
    <i class="fa fa-whatsapp" aria-hidden="true"></i>
  </a>

  <!-- Firebase Configuration and Payment Script -->
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyDvpv148pehFCPMwuw1hDYPPnWA67EOHOU",
      authDomain: "isaacski-restaurant.firebaseapp.com",
      projectId: "isaacski-restaurant",
      storageBucket: "isaacski-restaurant.firebasestorage.app",
      messagingSenderId: "793597481997",
      appId: "1:793597481997:web:fce9cb43ca442eee7b7144",
      measurementId: "G-CNYCFT8N3F"
    };

    // Initialize Firebase
    let db;
    try {
      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }
      db = firebase.firestore();
      console.log("‚úÖ Firebase initialized successfully in order page");
    } catch (error) {
      console.error("‚ùå Firebase initialization error:", error);
    }

    // Test Firebase connection
    document.getElementById('testFirebaseBtn').addEventListener('click', function () {
      const testResult = document.getElementById('testResult');

      try {
        if (typeof firebase === 'undefined') {
          testResult.innerHTML = '<span class="text-danger">‚ùå Firebase not loaded</span>';
          return;
        }

        if (!firebase.apps.length) {
          testResult.innerHTML = '<span class="text-danger">‚ùå Firebase not initialized</span>';
          return;
        }

        const testData = {
          test: true,
          message: "Firebase test successful",
          timestamp: new Date()
        };

        db.collection('test').add(testData)
          .then((docRef) => {
            testResult.innerHTML = '<span class="text-success">‚úÖ Firebase working! Test document created.</span>';
            console.log("Test document ID:", docRef.id);
          })
          .catch((error) => {
            testResult.innerHTML = `<span class="text-danger">‚ùå Firebase error: ${error.message}</span>`;
            console.error("Firebase test error:", error);
          });

      } catch (error) {
        testResult.innerHTML = `<span class="text-danger">‚ùå Error: ${error.message}</span>`;
        console.error("Test error:", error);
      }
    });
  </script>

  <script>
    // Initialize EmailJS
    (function () {
      emailjs.init("-WX6aDIktn3nAw81E");
    })();

    // Total Cost Calculation
    function extractPrice(val) {
      if (!val) return 0;
      var match = val.match(/¬¢([\d.]+)/);
      return match ? parseFloat(match[1]) : 0;
    }

    function do_total() {
      var total = 0;

      // Main Dish
      var main = document.getElementById("main_dishes");
      if (main && main.value) total += extractPrice(main.value);

      // Protein
      var protein = document.getElementById("protein");
      if (protein && protein.value)
        total += extractPrice(protein.value);

      // Extra Protein
      var protein2 = document.getElementById("protein2");
      if (protein2 && protein2.value)
        total += extractPrice(protein2.value);

      // Accompaniment
      var acc = document.getElementById("Accompaniment");
      if (acc && acc.value) total += extractPrice(acc.value);

      // Drinks
      var drink = document.getElementById("Drinks");
      if (drink && drink.value) total += extractPrice(drink.value);

      // Packaging
      var packaging = document.getElementById("Packaging");
      if (packaging && packaging.value)
        total += extractPrice(packaging.value);

      // Delivery
      var delivery = document.getElementById("Delivery");
      if (delivery && delivery.value)
        total += extractPrice(delivery.value);

      // Show total
      document.getElementById("total-cost").textContent =
        "¬¢" + total.toFixed(2);
      document.getElementById("amount").value = total.toFixed(2);
    }

    // Attach do_total to all relevant selects
    document.addEventListener("DOMContentLoaded", function () {
      [
        "main_dishes",
        "protein",
        "protein2",
        "Accompaniment",
        "Drinks",
        "Packaging",
        "Delivery",
      ].forEach(function (id) {
        var el = document.getElementById(id);
        if (el) el.addEventListener("change", do_total);
      });

      // Initial calculation
      do_total();
    });

    // Save order to Firebase - FIXED VERSION
    async function saveOrderToFirebase(orderData, orderId, paymentReference) {
      try {
        console.log("üíæ Starting Firebase save for order:", orderId);

        // Check if Firebase is initialized
        if (!db) {
          throw new Error("Firebase not initialized");
        }

        const firebaseOrderData = {
          orderId: orderId,
          customerName: orderData.fullname,
          customerEmail: orderData.email,
          customerPhone: orderData.telephone,
          vendorLocation: orderData.vendor_location,
          additionalNotes: orderData.message || 'None',

          // Order items
          mainDish: orderData.main_dishes,
          protein: orderData.protein,
          extraProtein: orderData.protein2 || 'None',
          accompaniment: orderData.Accompaniment || 'None',
          drinks: orderData.Drinks || 'None',
          packaging: orderData.Packaging,
          deliveryPeriod: orderData.Delivery,

          // Payment details
          totalAmount: parseFloat(document.getElementById('amount').value),
          currency: 'GHS',
          paymentReference: paymentReference,
          paymentStatus: 'completed',
          status: 'pending',

          // Timestamps
          timestamp: firebase.firestore.FieldValue.serverTimestamp(),
          orderDate: new Date().toISOString(),
          source: 'website-paystack'
        };

        console.log("üì¶ Order data prepared:", firebaseOrderData);

        // Save to Firebase using set() with the orderId as document ID
        await db.collection('orders').doc(orderId).set(firebaseOrderData);
        console.log('‚úÖ Order saved to Firebase successfully');
        return true;

      } catch (error) {
        console.error('‚ùå Error saving order to Firebase:', error);
        throw error;
      }
    }

    // Paystack Payment with Firebase Integration - FIXED VERSION
    document.getElementById("pay-now-btn").addEventListener("click", function () {
      const form = document.getElementById("paymentForm");
      const formData = new FormData(form);
      const data = {};
      formData.forEach((value, key) => {
        data[key] = value;
      });

      // Basic validation
      if (!data.fullname || !data.email || !data.telephone || !data.vendor_location) {
        alert("Please fill in all required fields: Full Name, Email, Telephone, and Vendor Location.");
        return;
      }

      if (!data.main_dishes || !data.protein || !data.Packaging || !data.Delivery) {
        alert("Please select Main Dish, Protein, Packaging, and Delivery Period.");
        return;
      }

      // Get total
      const totalText = document.getElementById("total-cost").textContent;
      const total = totalText.replace(/[^\d.]/g, "");
      if (!total || isNaN(parseFloat(total)) || parseFloat(total) <= 0) {
        alert("Please select your meal to calculate total cost.");
        return;
      }

      if (typeof PaystackPop === "undefined") {
        alert("Paystack is not loaded. Check your internet connection.");
        return;
      }

      // Generate order ID
      const orderId = 'ORDER-' + Math.random().toString(36).substr(2, 9).toUpperCase();

      console.log("üîÑ Starting payment process for order:", orderId);

      const handler = PaystackPop.setup({
        key: "pk_test_daec5eba6470db795511d6c5b8b29469f938ea34",
        email: data.email,
        amount: parseFloat(total) * 100,
        currency: "GHS",
        ref: orderId,
        metadata: {
          custom_fields: [
            {
              display_name: "Full Name",
              variable_name: "full_name",
              value: data.fullname
            },
            {
              display_name: "Telephone",
              variable_name: "telephone",
              value: data.telephone
            },
            {
              display_name: "Order ID",
              variable_name: "order_id",
              value: orderId
            }
          ]
        },
        callback: function (response) {
          console.log("üí∞ Payment successful:", response);
          handlePaymentSuccess(response, data, orderId);
        },
        onClose: function () {
          console.log("‚ùå Payment cancelled by user");
          alert("Payment was cancelled.");
        },
      });

      handler.openIframe();
    });

    async function handlePaymentSuccess(response, data, orderId) {
      try {
        console.log("üîÑ Processing successful payment for order:", orderId);

        // 1. Save to Firebase first
        console.log("üíæ Saving to Firebase...");
        await saveOrderToFirebase(data, orderId, response.reference);
        console.log("‚úÖ Firebase save completed");

        // 2. Send email using Email.js
        console.log("üìß Sending email...");
        const templateParams = {
          fullname: data.fullname,
          email: data.email,
          telephone: data.telephone,
          vendor_location: data.vendor_location,
          message: data.message,
          main_dishes: data.main_dishes,
          protein: data.protein,
          protein2: data.protein2 || 'None',
          accompaniment: data.Accompaniment || 'None',
          drinks: data.Drinks || 'None',
          packaging: data.Packaging,
          delivery: data.Delivery,
          total_cost: document.getElementById('total-cost').textContent,
          order_id: orderId,
          payment_reference: response.reference,
          timestamp: new Date().toLocaleString()
        };

        await emailjs.send('service_uvwuw6g', 'template_phvfhln', templateParams);
        console.log('‚úÖ Email sent successfully via Email.js');

        // 3. Format WhatsApp message
        const whatsappMessage = `New Order Payment Successful! üí∞
Order ID: ${orderId}
Payment Ref: ${response.reference}

Customer Details:
üë§ Full Name: ${data.fullname}
üìß Email: ${data.email}
üìû Phone: ${data.telephone}
üìç Vendor Location: ${data.vendor_location}

Order Details:
üçõ Main Dish: ${data.main_dishes}
ü•© Protein: ${data.protein}
ü•© Extra Protein: ${data.protein2 || 'None'}
ü•ó Accompaniment: ${data.Accompaniment || 'None'}
ü•§ Drinks: ${data.Drinks || 'None'}
üì¶ Packaging: ${data.Packaging}
üöö Delivery: ${data.Delivery}

üí∞ Total: ${document.getElementById('total-cost').textContent}

üìù Additional Notes: ${data.message || 'None'}`;

        const whatsappLink = `https://wa.me/233549175604?text=${encodeURIComponent(whatsappMessage)}`;

        // Show success message
        alert("üéâ Order submitted successfully and payment completed! Order ID: " + orderId + "\n\nWhatsApp notification will open next.");

        // Reset form
        document.getElementById('paymentForm').reset();
        document.getElementById('total-cost').textContent = '¬¢0.00';

        // Open WhatsApp after a short delay
        setTimeout(() => {
          window.open(whatsappLink, "_blank");
        }, 1000);

      } catch (error) {
        console.error("‚ùå Error during order processing:", error);
        alert("Payment was successful but there was an issue processing your order. Please contact us with your Order ID: " + orderId + "\n\nError: " + error.message);
      }
    }

    // Debug function to test Firebase directly
    window.testFirebaseSave = async function () {
      const testOrder = {
        fullname: "Test Customer " + new Date().toLocaleTimeString(),
        email: "test@example.com",
        telephone: "1234567890",
        vendor_location: "central-market",
        message: "Test order from debug function",
        main_dishes: "Jollof - ¬¢20.00",
        protein: "Chicken - ¬¢7.00",
        protein2: "None",
        Accompaniment: "None",
        Drinks: "None",
        Packaging: "TakeAway Pack - ¬¢2.00",
        Delivery: "Today - ¬¢6.50"
      };

      const testOrderId = 'TEST-' + Math.random().toString(36).substr(2, 9).toUpperCase();

      try {
        await saveOrderToFirebase(testOrder, testOrderId, 'TEST-REF');
        alert("‚úÖ Test order saved successfully! ID: " + testOrderId);
      } catch (error) {
        alert("‚ùå Test failed: " + error.message);
      }
    };
  </script>

  <!-- Footer -->
  <footer class="bg1">
    <div class="container p-t-40 p-b-70">
      <div class="row">
        <div class="col-sm-6 col-md-4 p-t-50">
          <!-- - -->
          <h4 class="txt13 m-b-33">Contact Us</h4>

          <ul class="m-b-70">
            <li class="txt14 m-b-14">
              <i class="fa fa-map-marker fs-16 dis-inline-block size19" aria-hidden="true"></i>
              East Legon, Accra, Ghana
            </li>

            <li class="txt14 m-b-14">
              <i class="fa fa-phone fs-16 dis-inline-block size19" aria-hidden="true"></i>
              (+233) 24 123 4567
            </li>

            <li class="txt14 m-b-14">
              <i class="fa fa-envelope fs-13 dis-inline-block size19" aria-hidden="true"></i>
              <a href="mailto:restaurant@gmail.com" class="__cf_email__"
                data-cfemail="7d1e1213091c1e093d0e140918531e1210">restaurant@gmail.com</a>
            </li>
          </ul>

          <!-- - -->
          <h4 class="txt13 m-b-32">Opening Times</h4>

          <ul>
            <li class="txt14">08:30 AM ‚Äì 08:00 PM</li>

            <li class="txt14">Every Day</li>
          </ul>
        </div>

        <div class="col-sm-6 col-md-4 p-t-50">
          <!-- - -->
          <h4 class="txt13 m-b-33">Latest twitter</h4>

          <div class="m-b-25">
            <span class="fs-13 color2 m-r-5">
              <i class="fa fa-twitter" aria-hidden="true"></i>
            </span>
            <a href="#" class="txt15"> @Isaacski Restaurant </a>

            <p class="txt14 m-b-18">
              Excited to announce our new menu! Try our chef's specials this
              weekend.
              <a href="#" class="txt15"> www.isaacskirestaurant.com </a>
            </p>

            <span class="txt16"> 21 Dec 2017 </span>
          </div>

          <div>
            <span class="fs-13 color2 m-r-5">
              <i class="fa fa-twitter" aria-hidden="true"></i>
            </span>
            <a href="#" class="txt15"> @Big Restaurant </a>

            <p class="txt14 m-b-18">
              Join us for our grand opening! Enjoy live music, delicious food,
              and great company.
              <a href="#" class="txt15"> www.bigrestaurant.com </a>
            </p>

            <span class="txt16"> 21 Dec 2017 </span>
          </div>
        </div>

        <div class="col-sm-6 col-md-4 p-t-50">
          <!-- - -->
          <h4 class="txt13 m-b-38">Gallery</h4>

          <!-- Gallery footer -->
          <div class="wrap-gallery-footer flex-w">
            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-01.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-01.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-02.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-02.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-03.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-03.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-04.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-04.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-05.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-05.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-06.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-06.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-07.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-07.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-08.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-08.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-09.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-09.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-10.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-10.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-11.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-11.jpg" alt="GALLERY" />
            </a>

            <a class="item-gallery-footer wrap-pic-w" href="images/photo-gallery-12.jpg" data-lightbox="gallery-footer">
              <img src="images/photo-gallery-thumb-12.jpg" alt="GALLERY" />
            </a>
          </div>
        </div>
      </div>
    </div>

    <div class="end-footer bg2">
      <div class="container">
        <div class="flex-sb-m flex-w p-t-22 p-b-22">
          <div class="p-t-5 p-b-5">
            <a href="#" class="fs-15 c-white"><i class="fa fa-instagram m-l-18" aria-hidden="true"></i></a>
            <a href="#" class="fs-15 c-white"><i class="fa fa-facebook m-l-18" aria-hidden="true"></i></a>
            <a href="#" class="fs-15 c-white"><i class="fa fa-twitter m-l-18" aria-hidden="true"></i></a>
          </div>

          <div class="txt17 p-r-20 p-t-5 p-b-5">
            @ 2025 Isaacski Web Development Agency.
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- Back to top -->
  <div class="btn-back-to-top bg0-hov" id="myBtn">
    <span class="symbol-btn-back-to-top">
      <i class="fa fa-angle-double-up" aria-hidden="true"></i>
    </span>
  </div>

  <!-- Chat Us On Whatsapp -->
  <a href="https://api.whatsapp.com/send?phone=233549175604&text=Hello%20Isaacski%20Restaurant" class="whatsapp-chat"
    target="_blank" rel="noopener noreferrer">
    <i class="fa fa-whatsapp" aria-hidden="true"></i>
  </a>

  <script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
  <script type="text/javascript" src="vendor/jquery/jquery-3.2.1.min.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/animsition/js/animsition.min.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/bootstrap/js/popper.js"></script>
  <script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>

  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/select2/select2.min.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/daterangepicker/moment.min.js"></script>
  <script type="text/javascript" src="vendor/daterangepicker/daterangepicker.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/slick/slick.min.js"></script>
  <script type="text/javascript" src="js/slick-custom.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/parallax100/parallax100.js"></script>
  <script type="text/javascript">
    $(".parallax100").parallax100();
  </script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/countdowntime/countdowntime.js"></script>
  <!--===============================================================================================-->
  <script type="text/javascript" src="vendor/lightbox2/js/lightbox.min.js"></script>
  <!--===============================================================================================-->
  <script src="js/main.js"></script>
  <script src="js/payment.js"></script>
  <script src="js/whatsaap-api.js"></script>
  <script src="js/script.js"></script>
  <script src="js/email-template.js"></script>

  <script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
    integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ=="
    data-cf-beacon='{"rayId":"94b79e40ee6cee0a","version":"2025.5.0","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"cd0b4b3a733644fc843ef0b185f98241","b":1}'
    crossorigin="anonymous"></script>

  <script>
    // Debug script for order.html
    console.log("=== ORDER PAGE DEBUG ===");

    // Check if Firebase is loaded
    console.log("Firebase available:", typeof firebase !== 'undefined');
    console.log("Firebase apps:", firebase?.apps?.length || 0);

    // Test Firebase directly
    window.debugFirebase = async function () {
      console.log("=== DEBUG: Testing Firebase ===");

      try {
        // Test config
        const firebaseConfig = {
          apiKey: "AIzaSyDvpv148pehFCPMwuw1hDYPPnWA67EOHOU",
          authDomain: "isaacski-restaurant.firebaseapp.com",
          projectId: "isaacski-restaurant",
          storageBucket: "isaacski-restaurant.firebasestorage.app",
          messagingSenderId: "793597481997",
          appId: "1:793597481997:web:fce9cb43ca442eee7b7144",
          measurementId: "G-CNYCFT8N3F"
        };

        // Initialize if not already
        if (!firebase.apps.length) {
          firebase.initializeApp(firebaseConfig);
          console.log("‚úÖ Firebase initialized in debug");
        }

        const db = firebase.firestore();

        // Test write
        const testData = {
          debug: true,
          message: "Debug test from order page",
          timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };

        const docRef = await db.collection('debug').add(testData);
        console.log("‚úÖ Debug test successful! ID:", docRef.id);
        alert(`‚úÖ Debug successful! Document: ${docRef.id}`);

      } catch (error) {
        console.error("‚ùå Debug error:", error);
        alert(`‚ùå Debug failed: ${error.message}`);
      }
    };

    // Add debug button to page
    document.addEventListener('DOMContentLoaded', function () {
      const debugBtn = document.createElement('button');
      debugBtn.textContent = 'DEBUG: Test Firebase';
      debugBtn.className = 'btn btn-warning';
      debugBtn.style.position = 'fixed';
      debugBtn.style.top = '10px';
      debugBtn.style.right = '10px';
      debugBtn.style.zIndex = '9999';
      debugBtn.onclick = debugFirebase;

      document.body.appendChild(debugBtn);
    });
  </script>
</body>

</html>